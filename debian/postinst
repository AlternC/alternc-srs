#!/bin/bash -e

## Local variable
postfix_instance_srs_name="postfix-out"

case "$1" in
	configure)
		if [[ ! $(postmulti -l -i ${postfix_instance_srs_name}) ]]; then
			postmulti -e init
			postmulti -I postfix-out -G mta -e create
		fi
		postconf -c /etc/${postfix_instance_srs_name} -X sender_canonical_maps sender_canonical_classes recipient_canonical_maps recipient_canonical_classes
		postconf -c /etc/postfix/ \
			sender_canonical_maps=mysql:/etc/postfix/mymail2mail.cf,socketmap:inet:127.0.0.1:10026:forward \
			sender_canonical_classes=envelope_sender \
			recipient_canonical_maps=mysql:/etc/postfix/mymail2mail.cf,socketmap:inet:127.0.0.1:10026:reverse \
			recipient_canonical_classes=envelope_recipient,header_recipient
		service postfix restart
	;;

esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.
#DEBHELPER#
